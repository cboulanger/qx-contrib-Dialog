{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/qx-contrib-Dialog/node_modules/qxcompiler/node_modules/qooxdoo-sdk/framework/source/class/qx/theme/manager/Appearance.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "extend",
    "core",
    "Object",
    "construct",
    "__styleCache",
    "__aliasMap",
    "properties",
    "theme",
    "check",
    "nullable",
    "event",
    "apply",
    "members",
    "__defaultStates",
    "_applyTheme",
    "__resolveId",
    "id",
    "defaultId",
    "chain",
    "db",
    "appearances",
    "entry",
    "divider",
    "end",
    "splitted",
    "split",
    "chainCopy",
    "lang",
    "Array",
    "clone",
    "alias",
    "length",
    "unshift",
    "pop",
    "baseid",
    "join",
    "mapped",
    "i",
    "shift",
    "subId",
    "resolved",
    "debug",
    "info",
    "include",
    "style",
    "styleFrom",
    "states",
    "getTheme",
    "aliasMap",
    "name",
    "warn",
    "unique",
    "bits",
    "$$bits",
    "$$length",
    "sum",
    "state",
    "cache",
    "undefined",
    "result",
    "base",
    "incl",
    "local",
    "baseIncludeKey",
    "hasOwnProperty",
    "baseKey",
    "includeKey",
    "localKey",
    "manager",
    "Appearance"
  ],
  "mappings": "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",
  "file": "Appearance.js",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Andreas Ecker (ecker)\n\n************************************************************************ */\n\n/**\n * Manager for appearance themes\n */\nqx.Class.define(\"qx.theme.manager.Appearance\",\n{\n  type : \"singleton\",\n  extend : qx.core.Object,\n\n\n\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  construct : function()\n  {\n    this.base(arguments);\n\n    this.__styleCache = {};\n    this.__aliasMap = {};\n  },\n\n\n\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties :\n  {\n    /** Currently used appearance theme */\n    theme :\n    {\n      check : \"Theme\",\n      nullable : true,\n      event : \"changeTheme\",\n      apply : \"_applyTheme\"\n    }\n  },\n\n\n\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members :\n  {\n    /**\n     * @lint ignoreReferenceField(__defaultStates)\n     */\n    __defaultStates : {},\n    __styleCache : null,\n    __aliasMap : null,\n\n\n    // property apply\n    _applyTheme : function() {\n      // empty the caches\n      this.__aliasMap = {};\n      this.__styleCache = {};\n    },\n\n\n    /*\n    ---------------------------------------------------------------------------\n      THEME HELPER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Returns the appearance entry ID to use\n     * when all aliases etc. are processed.\n     *\n     * @param id {String} ID to resolve.\n     * @param theme {Theme} Theme to use for lookup.\n     * @param defaultId {String} ID for a fallback.\n     * @param chain {Array} The appearance id chain.\n     * @return {String} Resolved ID\n     */\n    __resolveId : function(id, theme, defaultId, chain)\n    {\n      var db = theme.appearances;\n      var entry = db[id];\n\n      if (!entry)\n      {\n        var divider = \"/\";\n        var end = [];\n        var splitted = id.split(divider);\n        var chainCopy = qx.lang.Array.clone(splitted);\n        var alias;\n\n        while (!entry && splitted.length > 0)\n        {\n          end.unshift(splitted.pop());\n          var baseid = splitted.join(divider);\n          entry = db[baseid];\n\n          if (entry)\n          {\n            alias = entry.alias || entry;\n\n            if (typeof alias === \"string\")\n            {\n              var mapped = alias + divider + end.join(divider);\n              return this.__resolveId(mapped, theme, defaultId, chainCopy);\n            }\n          }\n        }\n\n        // check if we find a control fitting in the appearance [BUG #4020]\n        for (var i = 0; i < end.length - 1; i++) {\n          // remove the first id, it has already been checked at startup\n          end.shift();\n          // build a new subid without the former first id\n          var subId = end.join(divider);\n          var resolved = this.__resolveId(subId, theme, null, chainCopy);\n          if (resolved) {\n            return resolved;\n          }\n        }\n\n        // check for the fallback\n        if (defaultId != null) {\n          return this.__resolveId(defaultId, theme, null, chainCopy);\n        }\n\n        // it's safe to output this message here since we can be sure that the return\n        // value is 'null' and something went wrong with the id lookup.\n        if (qx.core.Environment.get(\"qx.debug\"))\n        {\n          if (typeof chain !== \"undefined\") {\n            this.debug(\"Cannot find a matching appearance for '\" + chain.join(\"/\") + \"'.\");\n\n            if (chain.length > 1) {\n              this.info(\"Hint: This may be an issue with nested child controls and a missing alias definition in the appearance theme.\");\n            }\n          }\n        }\n\n        return null;\n      }\n      else if (typeof entry === \"string\")\n      {\n        return this.__resolveId(entry, theme, defaultId, chainCopy);\n      }\n      else if (entry.include && !entry.style)\n      {\n        return this.__resolveId(entry.include, theme, defaultId, chainCopy);\n      }\n\n      return id;\n    },\n\n\n    /**\n     * Get the result of the \"state\" function for a given id and states\n     *\n     * @param id {String} id of the appearance (e.g. \"button\", \"label\", ...)\n     * @param states {Map} hash map defining the set states\n     * @param theme {Theme?} appearance theme\n     * @param defaultId {String} fallback id.\n     * @return {Map} map of widget properties as returned by the \"state\" function\n     */\n    styleFrom : function(id, states, theme, defaultId)\n    {\n      if (!theme) {\n        theme = this.getTheme();\n      }\n\n      // Resolve ID\n      var aliasMap = this.__aliasMap;\n      if(!aliasMap[theme.name]) {\n        aliasMap[theme.name] = {};\n      }\n      var resolved = aliasMap[theme.name][id];\n      if (!resolved) {\n        resolved = aliasMap[theme.name][id] = this.__resolveId(id, theme, defaultId);\n      }\n\n      // Query theme for ID\n      var entry = theme.appearances[resolved];\n      if (!entry)\n      {\n        this.warn(\"Missing appearance: \" + id);\n        return null;\n      }\n\n      // Entries with includes, but without style are automatically merged\n      // by the ID handling in {@link #getEntry}. When there is no style method in the\n      // final object the appearance is empty and null could be returned.\n      if (!entry.style) {\n        return null;\n      }\n\n      // Build an unique cache name from ID and state combination\n      var unique = resolved;\n      if (states)\n      {\n        // Create data fields\n        var bits = entry.$$bits;\n        if (!bits)\n        {\n          bits = entry.$$bits = {};\n          entry.$$length = 0;\n        }\n\n        // Compute sum\n        var sum = 0;\n        for (var state in states)\n        {\n          if (!states[state]) {\n            continue;\n          }\n\n          if (bits[state] == null) {\n            bits[state] = 1<<entry.$$length++;\n          }\n\n          sum += bits[state];\n        }\n\n        // Only append the sum if it is bigger than zero\n        if (sum > 0) {\n          unique += \":\" + sum;\n        }\n      }\n\n      // Using cache if available\n      var cache = this.__styleCache;\n      if (cache[theme.name] && (cache[theme.name][unique] !== undefined)) {\n        return cache[theme.name][unique];\n      }\n\n      // Fallback to default (empty) states map\n      if (!states) {\n        states = this.__defaultStates;\n      }\n\n      // Compile the appearance\n      var result;\n\n      // If an include or base is defined, too, we need to merge the entries\n      if (entry.include || entry.base)\n      {\n\n        // Gather included data\n        var incl;\n        if (entry.include) {\n          incl = this.styleFrom(entry.include, states, theme, defaultId);\n        }\n\n        // This process tries to insert the original data first, and\n        // append the new data later, to higher prioritize the local\n        // data above the included/inherited data. This is especially needed\n        // for property groups or properties which includes other\n        // properties when modified.\n        var local = entry.style(states, incl);\n\n        // Create new map\n        result = {};\n\n        // Copy base data, but exclude overwritten local and included stuff\n        if (entry.base)\n        {\n          var base = this.styleFrom(resolved, states, entry.base, defaultId);\n\n          if (entry.include)\n          {\n            for (var baseIncludeKey in base)\n            {\n              if (!incl.hasOwnProperty(baseIncludeKey) && !local.hasOwnProperty(baseIncludeKey)) {\n                result[baseIncludeKey] = base[baseIncludeKey];\n              }\n            }\n          }\n          else\n          {\n            for (var baseKey in base)\n            {\n              if (!local.hasOwnProperty(baseKey)) {\n                result[baseKey] = base[baseKey];\n              }\n            }\n          }\n        }\n\n        // Copy include data, but exclude overwritten local stuff\n        if (entry.include)\n        {\n          for (var includeKey in incl)\n          {\n            if (!local.hasOwnProperty(includeKey)) {\n              result[includeKey] = incl[includeKey];\n            }\n          }\n        }\n\n        // Append local data\n        for (var localKey in local) {\n          result[localKey] = local[localKey];\n        }\n      }\n      else\n      {\n        result = entry.style(states);\n      }\n\n      // Cache new entry and return\n      if(!cache[theme.name]) {\n        cache[theme.name] = {};\n      }\n       return cache[theme.name][unique] = result || null;\n    }\n  }\n});\n"
  ]
}