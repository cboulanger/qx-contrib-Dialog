{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/qx-contrib-Dialog/node_modules/qxcompiler/node_modules/qooxdoo-sdk/framework/source/class/qx/event/handler/Focus.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "event",
    "IEventHandler",
    "IDisposable",
    "construct",
    "manager",
    "_manager",
    "_window",
    "getWindow",
    "_document",
    "document",
    "_root",
    "documentElement",
    "_body",
    "body",
    "Environment",
    "get",
    "parseFloat",
    "application",
    "Inline",
    "Init",
    "getApplication",
    "__needsScrollFix",
    "_initObserver",
    "properties",
    "active",
    "apply",
    "nullable",
    "focus",
    "statics",
    "PRIORITY",
    "Registration",
    "PRIORITY_NORMAL",
    "SUPPORTED_TYPES",
    "blur",
    "focusin",
    "focusout",
    "activate",
    "deactivate",
    "IGNORE_CAN_HANDLE",
    "FOCUSABLE_ELEMENTS",
    "select",
    "a",
    "button",
    "frame",
    "iframe",
    "img",
    "input",
    "object",
    "textarea",
    "members",
    "__onNativeMouseDownWrapper",
    "__onNativeMouseUpWrapper",
    "__onNativeFocusWrapper",
    "__onNativeBlurWrapper",
    "__onNativeDragGestureWrapper",
    "__onNativeSelectStartWrapper",
    "__onNativeFocusInWrapper",
    "__onNativeFocusOutWrapper",
    "__previousFocus",
    "__previousActive",
    "__down",
    "__up",
    "__relatedTarget",
    "canHandleEvent",
    "target",
    "type",
    "registerEvent",
    "capture",
    "unregisterEvent",
    "element",
    "window",
    "setTimeout",
    "selection",
    "bom",
    "Selection",
    "length",
    "createTextRange",
    "textRange",
    "moveStart",
    "value",
    "collapse",
    "ex",
    "setFocus",
    "setActive",
    "getActive",
    "resetActive",
    "getFocus",
    "resetFocus",
    "tryActivate",
    "__findActivatableElement",
    "__fireEvent",
    "related",
    "bubbles",
    "evt",
    "createEvent",
    "Focus",
    "dispatchEvent",
    "_windowFocused",
    "__doWindowBlur",
    "__doWindowFocus",
    "lang",
    "Function",
    "listener",
    "__onNativeMouseDown",
    "__onNativeMouseUp",
    "__onNativeFocus",
    "__onNativeBlur",
    "__onNativeDragGesture",
    "Event",
    "addNativeListener",
    "__onNativeFocusIn",
    "__onNativeFocusOut",
    "__onNativeSelectStart",
    "domEvent",
    "_stopObserver",
    "removeNativeListener",
    "GlobalError",
    "observeMethod",
    "getTarget",
    "__isSelectable",
    "preventDefault",
    "focusTarget",
    "__findFocusableElement",
    "selectionStart",
    "selectionEnd",
    "relatedTarget",
    "getRelatedTarget",
    "unselectable",
    "empty",
    "current",
    "__fixFocus",
    "offsetWidth",
    "undefined",
    "parentNode",
    "__getCorrectFocusTarget",
    "focusedElement",
    "nodeName",
    "toLowerCase",
    "widget",
    "ui",
    "Widget",
    "getWidgetByElement",
    "textField",
    "getChildControl",
    "getContentElement",
    "getDomElement",
    "__isFocusable",
    "el",
    "index",
    "Attribute",
    "focusable",
    "handler",
    "tagName",
    "nodeType",
    "getAttribute",
    "orig",
    "node",
    "attr",
    "_applyActive",
    "old",
    "scrollTo",
    "_applyFocus",
    "destruct",
    "__mouseActive",
    "defer",
    "addHandler",
    "entry",
    "toUpperCase"
  ],
  "mappings": "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",
  "file": "Focus.js",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2007-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Fabian Jakobs (fjakobs)\n     * Christian Hagendorn (chris_schmidt)\n\n************************************************************************ */\n\n/**\n * This handler is used to normalize all focus/activation requirements\n * and normalize all cross browser quirks in this area.\n *\n * Notes:\n *\n * * Webkit and Opera (before 9.5) do not support tabIndex for all elements\n * (See also: https://bugs.webkit.org/show_bug.cgi?id=7138)\n *\n * * TabIndex is normally 0, which means all naturally focusable elements are focusable.\n * * TabIndex > 0 means that the element is focusable and tabable\n * * TabIndex < 0 means that the element, even if naturally possible, is not focusable.\n *\n * NOTE: Instances of this class must be disposed of after use\n *\n * @use(qx.event.dispatch.DomBubbling)\n */\nqx.Class.define(\"qx.event.handler.Focus\",\n{\n  extend : qx.core.Object,\n  implement : [ qx.event.IEventHandler, qx.core.IDisposable ],\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  /**\n   * Create a new instance\n   *\n   * @param manager {qx.event.Manager} Event manager for the window to use\n   *\n   * @ignore(qx.application.Inline)\n   */\n  construct : function(manager)\n  {\n    this.base(arguments);\n\n    // Define shorthands\n    this._manager = manager;\n    this._window = manager.getWindow();\n    this._document = this._window.document;\n    this._root = this._document.documentElement;\n    this._body = this._document.body;\n\n    if ((qx.core.Environment.get(\"os.name\") == \"ios\" && parseFloat(qx.core.Environment.get(\"os.version\")) > 6) &&\n      (!qx.application.Inline || !qx.core.Init.getApplication() instanceof qx.application.Inline) )\n    {\n      this.__needsScrollFix = true;\n    }\n\n    // Initialize\n    this._initObserver();\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties :\n  {\n    /** The active DOM element */\n    active :\n    {\n      apply : \"_applyActive\",\n      nullable : true\n    },\n\n    /** The focussed DOM element */\n    focus :\n    {\n      apply : \"_applyFocus\",\n      nullable : true\n    }\n  },\n\n  /*\n  *****************************************************************************\n     STATICS\n  *****************************************************************************\n  */\n\n  statics :\n  {\n    /** @type {Integer} Priority of this handler */\n    PRIORITY : qx.event.Registration.PRIORITY_NORMAL,\n\n    /** @type {Map} Supported event types */\n    SUPPORTED_TYPES :\n    {\n      focus : 1,\n      blur : 1,\n      focusin : 1,\n      focusout : 1,\n      activate : 1,\n      deactivate : 1\n    },\n\n    /** @type {Integer} Whether the method \"canHandleEvent\" must be called */\n    IGNORE_CAN_HANDLE : true,\n\n    /**\n     * @type {Map} See: http://msdn.microsoft.com/en-us/library/ms534654(VS.85).aspx\n     */\n    FOCUSABLE_ELEMENTS : qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" :\n      {\n        a : 1,\n        body : 1,\n        button : 1,\n        frame : 1,\n        iframe : 1,\n        img : 1,\n        input : 1,\n        object : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"gecko\" :\n      {\n        a : 1,\n        body : 1,\n        button : 1,\n        frame : 1,\n        iframe : 1,\n        img : 1,\n        input : 1,\n        object : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"opera\" :\n      {\n        button : 1,\n        input : 1,\n        select : 1,\n        textarea : 1\n      },\n\n      \"webkit\" :\n      {\n        button : 1,\n        input : 1,\n        select : 1,\n        textarea : 1\n      }\n    })\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members :\n  {\n    __onNativeMouseDownWrapper : null,\n    __onNativeMouseUpWrapper : null,\n    __onNativeFocusWrapper : null,\n    __onNativeBlurWrapper : null,\n    __onNativeDragGestureWrapper : null,\n    __onNativeSelectStartWrapper : null,\n    __onNativeFocusInWrapper : null,\n    __onNativeFocusOutWrapper : null,\n    __previousFocus : null,\n    __previousActive : null,\n    __down : \"\",\n    __up : \"\",\n    __needsScrollFix : false,\n    __relatedTarget : null,\n\n    /*\n    ---------------------------------------------------------------------------\n      EVENT HANDLER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    // interface implementation\n    canHandleEvent : function(target, type) {},\n\n    // interface implementation\n    registerEvent : function(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    // interface implementation\n    unregisterEvent : function(target, type, capture) {\n      // Nothing needs to be done here\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      FOCUS/BLUR USER INTERFACE\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Focuses the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    focus : function(element)\n    {\n      // Fixed timing issue with IE, see [BUG #3267]\n      if ((qx.core.Environment.get(\"engine.name\") == \"mshtml\"))\n      {\n        window.setTimeout(function()\n        {\n          try {\n            // focus element before set cursor position\n            element.focus();\n\n            // Fixed cursor position issue with IE, only when nothing is selected.\n            // See [BUG #3519] for details.\n            var selection = qx.bom.Selection.get(element);\n            if (selection.length == 0 && typeof element.createTextRange == \"function\") {\n              var textRange = element.createTextRange();\n              textRange.moveStart('character', element.value.length);\n              textRange.collapse();\n              textRange.select();\n            }\n          } catch(ex) {}\n        }, 0);\n      }\n      else\n      {\n        // Fix re-focusing on mousup event\n        // See https://github.com/qooxdoo/qooxdoo/issues/9393 and\n        // discussion in https://github.com/qooxdoo/qooxdoo/pull/9394\n        window.setTimeout(function()\n        {\n          try {\n            element.focus();\n          } catch(ex) {}\n        }, 0);\n      }\n\n      this.setFocus(element);\n      this.setActive(element);\n    },\n\n    /**\n     * Activates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    activate : function(element) {\n      this.setActive(element);\n    },\n\n    /**\n     * Blurs the given DOM element\n     *\n     * @param element {Element} DOM element to focus\n     */\n    blur : function(element)\n    {\n      try {\n        element.blur();\n      } catch(ex) {}\n\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n\n      if (this.getFocus() === element) {\n        this.resetFocus();\n      }\n    },\n\n    /**\n     * Deactivates the given DOM element\n     *\n     * @param element {Element} DOM element to activate\n     */\n    deactivate : function(element)\n    {\n      if (this.getActive() === element) {\n        this.resetActive();\n      }\n    },\n\n    /**\n     * Tries to activate the given element. This checks whether\n     * the activation is allowed first.\n     *\n     * @param element {Element} DOM element to activate\n     */\n    tryActivate : function(element)\n    {\n      var active = this.__findActivatableElement(element);\n      if (active) {\n        this.setActive(active);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Shorthand to fire events from within this class.\n     *\n     * @param target {Element} DOM element which is the target\n     * @param related {Element} DOM element which is the related target\n     * @param type {String} Name of the event to fire\n     * @param bubbles {Boolean} Whether the event should bubble\n     * @return {qx.Promise?} a promise, if one or more of the event handlers returned a promise\n     */\n    __fireEvent : function(target, related, type, bubbles)\n    {\n      var Registration = qx.event.Registration;\n\n      var evt = Registration.createEvent(type, qx.event.type.Focus, [target, related, bubbles]);\n      return Registration.dispatchEvent(target, evt);\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      WINDOW FOCUS/BLUR SUPPORT\n    ---------------------------------------------------------------------------\n    */\n\n    /** @type {Boolean} Whether the window is focused currently */\n    _windowFocused : true,\n\n    /**\n     * Helper for native event listeners to react on window blur\n     */\n    __doWindowBlur : function()\n    {\n      // Omit doubled blur events\n      // which is a common behavior at least for gecko based clients\n      if (this._windowFocused)\n      {\n        this._windowFocused = false;\n        this.__fireEvent(this._window, null, \"blur\", false);\n      }\n    },\n\n\n    /**\n     * Helper for native event listeners to react on window focus\n     */\n    __doWindowFocus : function()\n    {\n      // Omit doubled focus events\n      // which is a common behavior at least for gecko based clients\n      if (!this._windowFocused)\n      {\n        this._windowFocused = true;\n        this.__fireEvent(this._window, null, \"focus\", false);\n      }\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE OBSERVER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Initializes event listeners.\n     *\n     * @signature function()\n     */\n    _initObserver : qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusWrapper = qx.lang.Function.listener(this.__onNativeFocus, this);\n        this.__onNativeBlurWrapper = qx.lang.Function.listener(this.__onNativeBlur, this);\n\n        this.__onNativeDragGestureWrapper = qx.lang.Function.listener(this.__onNativeDragGesture, this);\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        // Capturing is needed for gecko to correctly\n        // handle focus of input and textarea fields\n        qx.bom.Event.addNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n        qx.bom.Event.addNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n\n        // Capture drag events\n        qx.bom.Event.addNativeListener(this._window, \"draggesture\", this.__onNativeDragGestureWrapper, true);\n      },\n\n      \"mshtml\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n        this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n\n        // MSHTML supports their own focusin and focusout events\n        // To detect which elements get focus the target is useful\n        // The window blur can detected using focusout and look\n        // for the toTarget property which is empty in this case.\n        qx.bom.Event.addNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n        qx.bom.Event.addNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n\n        // Add selectstart to prevent selection\n        qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n          this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n          // Register events\n          qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.addNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n          qx.bom.Event.addNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n        },\n\n        \"default\" : function(domEvent)\n        {\n          // Bind methods\n          this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n          this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n          this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n          this.__onNativeFocusWrapper = qx.lang.Function.listener(this.__onNativeFocus, this);\n          this.__onNativeBlurWrapper = qx.lang.Function.listener(this.__onNativeBlur, this);\n\n          this.__onNativeSelectStartWrapper = qx.lang.Function.listener(this.__onNativeSelectStart, this);\n\n\n          // Register events\n          qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.addNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.addNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n\n          qx.bom.Event.addNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n          qx.bom.Event.addNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n        }\n      }),\n\n      \"opera\" : function()\n      {\n        // Bind methods\n        this.__onNativeMouseDownWrapper = qx.lang.Function.listener(this.__onNativeMouseDown, this);\n        this.__onNativeMouseUpWrapper = qx.lang.Function.listener(this.__onNativeMouseUp, this);\n\n        this.__onNativeFocusInWrapper = qx.lang.Function.listener(this.__onNativeFocusIn, this);\n        this.__onNativeFocusOutWrapper = qx.lang.Function.listener(this.__onNativeFocusOut, this);\n\n\n        // Register events\n        qx.bom.Event.addNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.addNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.addNativeListener(this._window, \"DOMFocusIn\", this.__onNativeFocusInWrapper, true);\n        qx.bom.Event.addNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n      }\n    }),\n\n    /**\n     * Disconnects event listeners.\n     *\n     * @signature function()\n     */\n    _stopObserver : qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n        qx.bom.Event.removeNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"draggesture\", this.__onNativeDragGestureWrapper, true);\n      },\n\n      \"mshtml\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n        qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function()\n        {\n          qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"focusin\", this.__onNativeFocusInWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"focusout\", this.__onNativeFocusOutWrapper);\n          qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper);\n        },\n\n        \"default\" : function()\n        {\n          qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n          qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n          qx.bom.Event.removeNativeListener(this._document, \"selectstart\", this.__onNativeSelectStartWrapper, false);\n\n          qx.bom.Event.removeNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n\n          qx.bom.Event.removeNativeListener(this._window, \"focus\", this.__onNativeFocusWrapper, true);\n          qx.bom.Event.removeNativeListener(this._window, \"blur\", this.__onNativeBlurWrapper, true);\n        }\n      }),\n\n      \"opera\" : function()\n      {\n        qx.bom.Event.removeNativeListener(this._document, \"mousedown\", this.__onNativeMouseDownWrapper, true);\n        qx.bom.Event.removeNativeListener(this._document, \"mouseup\", this.__onNativeMouseUpWrapper, true);\n\n        qx.bom.Event.removeNativeListener(this._window, \"DOMFocusIn\", this.__onNativeFocusInWrapper, true);\n        qx.bom.Event.removeNativeListener(this._window, \"DOMFocusOut\", this.__onNativeFocusOutWrapper, true);\n      }\n    }),\n\n    /*\n    ---------------------------------------------------------------------------\n      NATIVE LISTENERS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Native event listener for <code>draggesture</code> event\n     * supported by gecko. Used to stop native drag and drop when\n     * selection is disabled.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Drag_and_Drop\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeDragGesture : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>DOMFocusIn</code> or <code>focusin</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusIn : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        // Force window focus to be the first\n        this.__doWindowFocus();\n\n        // Update internal data\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        // IE focusin is also fired on elements which are not focusable at all\n        // We need to look up for the next focusable element.\n        var focusTarget = this.__findFocusableElement(target);\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        }\n\n        // Make target active\n        this.tryActivate(target);\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          // Force window focus to be the first\n          this.__doWindowFocus();\n\n          // Update internal data\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          // IE focusin is also fired on elements which are not focusable at all\n          // We need to look up for the next focusable element.\n          var focusTarget = this.__findFocusableElement(target);\n          if (focusTarget) {\n            this.setFocus(focusTarget);\n          }\n\n          // Make target active\n          this.tryActivate(target);\n        },\n\n        \"default\" : null\n      }),\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target == this._document || target == this._window)\n        {\n          this.__doWindowFocus();\n\n          if (this.__previousFocus)\n          {\n            this.setFocus(this.__previousFocus);\n            delete this.__previousFocus;\n          }\n\n          if (this.__previousActive)\n          {\n            this.setActive(this.__previousActive);\n            delete this.__previousActive;\n          }\n        }\n        else\n        {\n          this.setFocus(target);\n          this.tryActivate(target);\n\n          // Clear selection\n          if (!this.__isSelectable(target))\n          {\n            target.selectionStart = 0;\n            target.selectionEnd = 0;\n          }\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>DOMFocusOut</code> or <code>focusout</code>\n     * depending on the client's engine.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocusOut : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n        // If the focus goes to nowhere (the document is blurred)\n        if (relatedTarget == null)\n        {\n          // Update internal representation\n          this.__doWindowBlur();\n\n          // Reset active and focus\n          this.resetFocus();\n          this.resetActive();\n        }\n      },\n\n      \"webkit\" : qx.core.Environment.select(\"browser.name\",\n      {\n        // fix for [ISSUE #9174]\n        // distinguish bettween MS Edge, which is reported\n        // as engine webkit and all other webkit browsers\n        \"edge\" : function(domEvent)\n        {\n          var relatedTarget = qx.bom.Event.getRelatedTarget(domEvent);\n\n          // If the focus goes to nowhere (the document is blurred)\n          if (relatedTarget == null)\n          {\n            // Update internal representation\n            this.__doWindowBlur();\n\n            // Reset active and focus\n            this.resetFocus();\n            this.resetActive();\n          }\n        },\n\n        \"default\" : function(domEvent)\n        {\n          var target = qx.bom.Event.getTarget(domEvent);\n\n          if (target === this.getFocus()) {\n            this.resetFocus();\n          }\n\n          if (target === this.getActive()) {\n            this.resetActive();\n          }\n        }\n      }),\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target == this._document)\n        {\n          this.__doWindowBlur();\n\n          // Store old focus/active elements\n          // Opera do not fire focus events for them\n          // when refocussing the window (in my opinion an error)\n          this.__previousFocus = this.getFocus();\n          this.__previousActive = this.getActive();\n\n          this.resetFocus();\n          this.resetActive();\n        }\n        else\n        {\n          if (target === this.getFocus()) {\n            this.resetFocus();\n          }\n\n          if (target === this.getActive()) {\n            this.resetActive();\n          }\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>blur</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeBlur : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowBlur();\n\n          this.resetActive();\n          this.resetFocus();\n        }\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowBlur();\n\n          // Store old focus/active elements\n          // Opera do not fire focus events for them\n          // when refocussing the window (in my opinion an error)\n          this.__previousFocus = this.getFocus();\n          this.__previousActive = this.getActive();\n\n          this.resetActive();\n          this.resetFocus();\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>focus</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeFocus : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"gecko\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowFocus();\n\n          // Always speak of the body, not the window or document\n          target = this._body;\n        }\n\n        this.setFocus(target);\n        this.tryActivate(target);\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target === this._window || target === this._document)\n        {\n          this.__doWindowFocus();\n\n          if (this.__previousFocus)\n          {\n            this.setFocus(this.__previousFocus);\n            delete this.__previousFocus;\n          }\n\n          if (this.__previousActive)\n          {\n            this.setActive(this.__previousActive);\n            delete this.__previousActive;\n          }\n        }\n        else\n        {\n          this.__relatedTarget = domEvent.relatedTarget;\n          this.setFocus(target);\n          this.__relatedTarget = null;\n          this.tryActivate(target);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>mousedown</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseDown : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n\n        // Stop events when no focus element available (or blocked)\n        var focusTarget = this.__findFocusableElement(target);\n        if (focusTarget)\n        {\n          // Add unselectable to keep selection\n          if (!this.__isSelectable(target))\n          {\n            // The element is not selectable. Block selection.\n            target.unselectable = \"on\";\n\n            // Unselectable may keep the current selection which\n            // is not what we like when changing the focus element.\n            // So we clear it\n            try {\n              if (document.selection) {\n                document.selection.empty();\n              }\n            } catch (ex) {\n              // ignore 'Unknown runtime error'\n            }\n\n            // The unselectable attribute stops focussing as well.\n            // Do this manually.\n            try {\n              focusTarget.focus();\n            } catch (ex) {\n              // ignore \"Can't move focus of this control\" error\n            }\n          }\n        }\n        else\n        {\n          // Stop event for blocking support\n          qx.bom.Event.preventDefault(domEvent);\n\n          // Add unselectable to keep selection\n          if (!this.__isSelectable(target)) {\n            target.unselectable = \"on\";\n          }\n        }\n      },\n\n      \"webkit\" : function(domEvent) {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        } else {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"gecko\" : function(domEvent) {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (focusTarget) {\n          this.setFocus(focusTarget);\n        } else {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        var focusTarget = this.__findFocusableElement(target);\n\n        if (!this.__isSelectable(target)) {\n          // Prevent the default action for all non-selectable\n          // targets. This prevents text selection and context menu.\n          qx.bom.Event.preventDefault(domEvent);\n\n          // The stopped event keeps the selection\n          // of the previously focused element.\n          // We need to clear the old selection.\n          if (focusTarget)\n          {\n            var current = this.getFocus();\n            if (current && current.selectionEnd)\n            {\n              current.selectionStart = 0;\n              current.selectionEnd = 0;\n              current.blur();\n            }\n\n            // The prevented event also stop the focus, do\n            // it manually if needed.\n            if (focusTarget) {\n              this.setFocus(focusTarget);\n            }\n          }\n        } else if (focusTarget) {\n          this.setFocus(focusTarget);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Native event listener for <code>mouseup</code>.\n     *\n     * @signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeMouseUp : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (target.unselectable) {\n          target.unselectable = \"off\";\n        }\n\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"gecko\" : function(domEvent)\n      {\n        // As of Firefox 3.0:\n        // Gecko fires mouseup on XUL elements\n        // We only want to deal with real HTML elements\n        var target = qx.bom.Event.getTarget(domEvent);\n        while (target && target.offsetWidth === undefined) {\n          target = target.parentNode;\n        }\n\n        if (target) {\n          this.tryActivate(target);\n        }\n\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"opera\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        this.tryActivate(this.__fixFocus(target));\n      },\n\n      \"default\" : null\n    })),\n\n    /**\n     * Fix for bug #9331.\n     *\n     * @signature function(target)\n     * @param target {Element} element to check\n     * @return {Element} return correct target (in case of compound input controls should always return textfield);\n     */\n    __getCorrectFocusTarget: function(target)\n    {\n      var focusedElement = this.getFocus();\n      if (focusedElement && target != focusedElement) {\n        if (focusedElement.nodeName.toLowerCase() === \"input\" ||\n          focusedElement.nodeName.toLowerCase() === \"textarea\") {\n          return focusedElement;\n        }\n        // Check compound widgets\n        var widget = qx.ui.core.Widget.getWidgetByElement(focusedElement),\n          textField = widget && widget.getChildControl && widget.getChildControl(\"textfield\", true);\n\n        if (textField) {\n          return textField.getContentElement().getDomElement();\n        }\n      }\n      return target;\n    },\n\n    /**\n     * Fix for bug #2602.\n     *\n     * @signature function(target)\n     * @param target {Element} target element from mouse up event\n     * @return {Element} Element to activate;\n     */\n    __fixFocus : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n      {\n        \"mshtml\" : function(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        \"webkit\" : function(target) {\n          return this.__getCorrectFocusTarget(target);\n        },\n\n        \"default\" : function(target) {\n          return target;\n        }\n      })),\n\n    /**\n     * Native event listener for <code>selectstart</code>.\n     *\n     *@signature function(domEvent)\n     * @param domEvent {Event} Native event\n     */\n    __onNativeSelectStart : qx.event.GlobalError.observeMethod(qx.core.Environment.select(\"engine.name\",\n    {\n      \"mshtml\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"webkit\" : function(domEvent)\n      {\n        var target = qx.bom.Event.getTarget(domEvent);\n        if (!this.__isSelectable(target)) {\n          qx.bom.Event.preventDefault(domEvent);\n        }\n      },\n\n      \"default\" : null\n    })),\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER METHODS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Whether the given element is focusable. This is perfectly modeled to the\n     * browsers behavior and this way may differ in the various clients.\n     *\n     * @param el {Element} DOM Element to query\n     * @return {Boolean} Whether the element is focusable\n     */\n    __isFocusable : function(el)\n    {\n      var index = qx.bom.element.Attribute.get(el, \"tabIndex\");\n      if (index >= 1) {\n        return true;\n      }\n\n      var focusable = qx.event.handler.Focus.FOCUSABLE_ELEMENTS;\n      if (index >= 0 && focusable[el.tagName]) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Returns the next focusable parent element of an activated DOM element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element|null} The next focusable element.\n     */\n    __findFocusableElement : function(el)\n    {\n      while (el && el.nodeType === 1)\n      {\n        if (el.getAttribute(\"qxKeepFocus\") == \"on\") {\n          return null;\n        }\n\n        if (this.__isFocusable(el)) {\n          return el;\n        }\n\n        el = el.parentNode;\n      }\n\n      // This should be identical to the one which is selected when\n      // clicking into an empty page area. In mshtml this must be\n      // the body of the document.\n      return this._body;\n    },\n\n    /**\n     * Returns the next activatable element. May be the element itself.\n     * Works a bit different than the method {@link #__findFocusableElement}\n     * as it looks up for a parent which is has a keep focus flag. When\n     * there is such a parent it returns null otherwise the original\n     * incoming element.\n     *\n     * @param el {Element} Element to start lookup with.\n     * @return {Element} The next activatable element.\n     */\n    __findActivatableElement : function(el)\n    {\n      var orig = el;\n\n      while (el && el.nodeType === 1)\n      {\n        if (el.getAttribute(\"qxKeepActive\") == \"on\") {\n          return null;\n        }\n\n        el = el.parentNode;\n      }\n\n      return orig;\n    },\n\n    /**\n     * Whether the given el (or its content) should be selectable\n     * by the user.\n     *\n     * @param node {Element} Node to start lookup with\n     * @return {Boolean} Whether the content is selectable.\n     */\n    __isSelectable : function(node)\n    {\n      while(node && node.nodeType === 1)\n      {\n        var attr = node.getAttribute(\"qxSelectable\");\n        if (attr != null) {\n          return attr === \"on\";\n        }\n\n        node = node.parentNode;\n      }\n\n      return true;\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      PROPERTY APPLY ROUTINES\n    ---------------------------------------------------------------------------\n    */\n\n    // apply routine\n    _applyActive : function(value, old)\n    {\n      // Fire events\n      if (old) {\n        this.__fireEvent(old, value, \"deactivate\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"activate\", true);\n      }\n      // correct scroll position for iOS 7\n      if (this.__needsScrollFix) {\n        window.scrollTo(0, 0);\n      }\n    },\n\n    // apply routine\n    _applyFocus : function(value, old)\n    {\n      // Fire bubbling events\n      if (old) {\n        this.__fireEvent(old, value, \"focusout\", true);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old, \"focusin\", true);\n      }\n\n      // Fire after events\n      if (old) {\n        this.__fireEvent(old, value, \"blur\", false);\n      }\n\n      if (value) {\n        this.__fireEvent(value, old || this.__relatedTarget, \"focus\", false);\n      }\n    }\n  },\n\n  /*\n  *****************************************************************************\n     DESTRUCTOR\n  *****************************************************************************\n  */\n\n  destruct : function()\n  {\n    this._stopObserver();\n    this._manager = this._window = this._document = this._root = this._body =\n      this.__mouseActive = this.__relatedTarget = null;\n  },\n\n  /*\n  *****************************************************************************\n     DEFER\n  *****************************************************************************\n  */\n\n  defer : function(statics)\n  {\n    qx.event.Registration.addHandler(statics);\n\n    // For faster lookups generate uppercase tag names dynamically\n    var focusable = statics.FOCUSABLE_ELEMENTS;\n    for (var entry in focusable) {\n      focusable[entry.toUpperCase()] = 1;\n    }\n  }\n});\n"
  ]
}