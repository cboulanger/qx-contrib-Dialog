{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/qx-contrib-Dialog/node_modules/qxcompiler/node_modules/qooxdoo-sdk/framework/source/class/qx/ui/control/ColorPopup.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "popup",
    "Popup",
    "implement",
    "form",
    "IColorForm",
    "construct",
    "setLayout",
    "layout",
    "VBox",
    "_createChildControl",
    "_createBoxes",
    "addListener",
    "_onChangeVisibility",
    "properties",
    "appearance",
    "refine",
    "init",
    "value",
    "nullable",
    "apply",
    "event",
    "red",
    "check",
    "green",
    "blue",
    "members",
    "__minZIndex",
    "__boxes",
    "__colorSelectorWindow",
    "__colorSelector",
    "__buttonBar",
    "__recentTableId",
    "__fieldNumber",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "core",
    "Widget",
    "_onFieldPointerDown",
    "_onFieldPointerOver",
    "_onFieldPointerOut",
    "Button",
    "tr",
    "setAllowStretchX",
    "_onAutomaticBtnExecute",
    "add",
    "_onSelectorButtonExecute",
    "groupbox",
    "GroupBox",
    "HBox",
    "flex",
    "container",
    "Composite",
    "Basic",
    "_onColorSelectorOk",
    "_onColorSelectorCancel",
    "tables",
    "_tables",
    "table",
    "box",
    "field",
    "j",
    "tableId",
    "label",
    "i",
    "getChildControl",
    "setBackgroundColor",
    "values",
    "_createColorSelector",
    "win",
    "window",
    "Window",
    "setResizable",
    "moveTo",
    "ColorSelector",
    "btnCancel",
    "btnOk",
    "_applyValue",
    "old",
    "setRed",
    "setGreen",
    "setBlue",
    "rgb",
    "util",
    "ColorUtil",
    "stringToRgb",
    "_rotatePreviousColors",
    "vRecentTable",
    "vRecentBox",
    "newValue",
    "getValue",
    "vIndex",
    "indexOf",
    "lang",
    "Array",
    "removeAt",
    "length",
    "shift",
    "push",
    "vFields",
    "getChildren",
    "e",
    "vValue",
    "getBackgroundColor",
    "setValue",
    "hide",
    "getTarget",
    "getRed",
    "getGreen",
    "getBlue",
    "color",
    "rgbToRgbString",
    "exclude",
    "open",
    "sel",
    "close",
    "getVisibility",
    "locale",
    "Manager",
    "recent",
    "destruct",
    "destroy",
    "ColorPopup"
  ],
  "mappings": "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",
  "file": "ColorPopup.js",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Andreas Ecker (ecker)\n     * Jonathan Wei√ü (jonathan_rass)\n\n\n************************************************************************ */\n\n/**\n * A popup which contains palettes of colors and the possibility to open the\n * Colorselector to choose a color.\n *\n * @childControl field {qx.ui.core.Widget} shows preset colors\n * @childControl auto-button {qx.ui.form.Button} automatic button\n * @childControl selector-button {qx.ui.form.Button} button to open the color selector\n * @childControl preview-pane {qx.ui.groupbox.GroupBox} group box to show the old and the new color\n * @childControl selected-preview {qx.ui.container.Composite} show the selected color\n * @childControl current-preview {qx.ui.container.Composite} show the current color\n * @childControl colorselector-okbutton {qx.ui.form.Button} button of the colorselector\n * @childControl colorselector-cancelbutton {qx.ui.form.Button} button of the colorselector\n */\nqx.Class.define(\"qx.ui.control.ColorPopup\",\n{\n  extend : qx.ui.popup.Popup,\n  implement : [qx.ui.form.IColorForm],\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  construct : function()\n  {\n    this.base(arguments);\n\n    this.setLayout(new qx.ui.layout.VBox(5));\n\n    this._createChildControl(\"auto-button\");\n    this._createBoxes();\n    this._createChildControl(\"preview-pane\");\n    this._createChildControl(\"selector-button\");\n\n    this.addListener(\"changeVisibility\", this._onChangeVisibility, this);\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties :\n  {\n\n    // overridden\n    appearance :\n    {\n      refine : true,\n      init : \"colorpopup\"\n    },\n\n    /** The hex value of the selected color. */\n    value :\n    {\n      nullable : true,\n      apply : \"_applyValue\",\n      event : \"changeValue\"\n    },\n\n    /** The numeric red value of the selected color. */\n    red :\n    {\n      check : \"Number\",\n      init : null,\n      nullable : true,\n      event : \"changeRed\"\n    },\n\n    /** The numeric green value of the selected color. */\n    green :\n    {\n      check : \"Number\",\n      init : null,\n      nullable : true,\n      event : \"changeGreen\"\n    },\n\n    /** The numeric blue value of the selected color. */\n    blue :\n    {\n      check : \"Number\",\n      init : null,\n      nullable : true,\n      event : \"changeBlue\"\n    }\n  },\n\n\n\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members :\n  {\n    __minZIndex : 1e5,\n    __boxes : null,\n    __colorSelectorWindow : null,\n    __colorSelector : null,\n    __buttonBar : null,\n    __recentTableId : \"recent\",\n    __fieldNumber : 12,\n\n\n    // overridden\n    _createChildControlImpl : function(id, hash)\n    {\n      var control;\n\n      switch(id)\n      {\n        case \"field\":\n          control = new qx.ui.core.Widget;\n          control.addListener(\"pointerdown\", this._onFieldPointerDown, this);\n          control.addListener(\"pointerover\", this._onFieldPointerOver, this);\n          control.addListener(\"pointerout\", this._onFieldPointerOut, this);\n          break;\n\n        case \"auto-button\":\n          control = new qx.ui.form.Button(this.tr(\"Automatic\"));\n          control.setAllowStretchX(true);\n          control.addListener(\"execute\", this._onAutomaticBtnExecute, this);\n\n          this.add(control);\n          break;\n\n        case \"selector-button\":\n          control = new qx.ui.form.Button(this.tr(\"Open ColorSelector\"));\n          control.addListener(\"execute\", this._onSelectorButtonExecute, this);\n\n          this.add(control);\n          break;\n\n        case \"preview-pane\":\n          control = new qx.ui.groupbox.GroupBox(this.tr(\"Preview (Old/New)\"));\n          control.setLayout(new qx.ui.layout.HBox);\n\n          control.add(this._createChildControl(\"selected-preview\", true), {flex : 1});\n          control.add(this._createChildControl(\"current-preview\", true), {flex : 1});\n\n          this.add(control);\n          break;\n\n        case \"selected-preview\":\n          control = new qx.ui.container.Composite(new qx.ui.layout.Basic);\n          break;\n\n        case \"current-preview\":\n          control = new qx.ui.container.Composite(new qx.ui.layout.Basic);\n          break;\n\n        case \"colorselector-okbutton\":\n          control = new qx.ui.form.Button(this.tr(\"OK\"));\n          control.addListener(\"execute\", this._onColorSelectorOk, this);\n          break;\n\n        case \"colorselector-cancelbutton\":\n          control = new qx.ui.form.Button(this.tr(\"Cancel\"));\n          control.addListener(\"execute\", this._onColorSelectorCancel, this);\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    },\n\n\n\n\n    /*\n    ---------------------------------------------------------------------------\n      CREATOR SUBS\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Creates the GroupBoxes containing the colored fields.\n     */\n    _createBoxes : function()\n    {\n      this.__boxes = {};\n\n      var tables = this._tables;\n      var table, box, field;\n      var j=0;\n\n      for (var tableId in tables)\n      {\n        table = tables[tableId];\n\n        box = new qx.ui.groupbox.GroupBox(table.label);\n        box.setLayout(new qx.ui.layout.HBox);\n\n        this.__boxes[tableId] = box;\n        this.add(box);\n\n        for (var i=0; i<this.__fieldNumber; i++)\n        {\n          field = this.getChildControl(\"field#\" + (j++));\n          field.setBackgroundColor(table.values[i] || null);\n          box.add(field);\n        }\n      }\n    },\n\n\n    /**\n     * Creates the ColorSelector and adds buttons.\n     */\n    _createColorSelector : function()\n    {\n      if (this.__colorSelector) {\n        return;\n      }\n\n      var win = new qx.ui.window.Window(this.tr(\"Color Selector\"));\n      this.__colorSelectorWindow = win;\n      win.setLayout(new qx.ui.layout.VBox(16));\n      win.setResizable(false);\n      win.moveTo(20, 20);\n\n      this.__colorSelector = new qx.ui.control.ColorSelector();\n      win.add(this.__colorSelector);\n\n      this.__buttonBar = new qx.ui.container.Composite(new qx.ui.layout.HBox(8, \"right\"));\n      win.add(this.__buttonBar);\n\n      var btnCancel = this._createChildControl(\"colorselector-cancelbutton\");\n      var btnOk = this._createChildControl(\"colorselector-okbutton\");\n\n      this.__buttonBar.add(btnCancel);\n      this.__buttonBar.add(btnOk);\n    },\n\n\n\n\n\n    /*\n    ---------------------------------------------------------------------------\n      APPLY ROUTINES\n    ---------------------------------------------------------------------------\n    */\n\n    // Property apply\n    _applyValue : function(value, old)\n    {\n      if (value === null)\n      {\n        this.setRed(null);\n        this.setGreen(null);\n        this.setBlue(null);\n      }\n      else\n      {\n        var rgb = qx.util.ColorUtil.stringToRgb(value);\n        this.setRed(rgb[0]);\n        this.setGreen(rgb[1]);\n        this.setBlue(rgb[2]);\n      }\n\n      this.getChildControl(\"selected-preview\").setBackgroundColor(value);\n      this._rotatePreviousColors();\n    },\n\n\n    /**\n     * Adds the most recent selected color to the \"Recent colors\" list.\n     * If this list is full, the first color will be removed before inserting\n     * the new one.\n     */\n    _rotatePreviousColors : function()\n    {\n      if(!this._tables){\n        return;\n      }\n\n      var vRecentTable = this._tables[this.__recentTableId].values;\n      var vRecentBox = this.__boxes[this.__recentTableId];\n\n      if (!vRecentTable) {\n        return;\n      }\n\n      var newValue = this.getValue();\n\n      if (!newValue) {\n        return;\n      }\n\n      // Modifying incoming table\n      var vIndex = vRecentTable.indexOf(newValue);\n\n      if (vIndex != -1) {\n        qx.lang.Array.removeAt(vRecentTable, vIndex);\n      } else if (vRecentTable.length == this.__fieldNumber) {\n        vRecentTable.shift();\n      }\n\n      vRecentTable.push(newValue);\n\n      // Sync to visible fields\n      var vFields = vRecentBox.getChildren();\n\n      for (var i=0; i<vFields.length; i++) {\n        vFields[i].setBackgroundColor(vRecentTable[i] || null);\n      }\n    },\n\n\n\n    /*\n    ---------------------------------------------------------------------------\n      EVENT HANDLER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Listener of pointerdown event on a color field. Sets the ColorPoup's value\n     * to field's color value and paint the preview pane.\n     *\n     * @param e {qx.event.type.Pointer} Incoming event object\n     */\n    _onFieldPointerDown : function(e)\n    {\n      var vValue = this.getChildControl(\"current-preview\").getBackgroundColor();\n      this.setValue(vValue);\n\n      if (vValue) {\n        this.hide();\n      }\n    },\n\n\n    /**\n     * Listener of pointermove event on a color field. Sets preview pane's\n     * background color to the field's color value.\n     *\n     * @param e {qx.event.type.Pointer} Incoming event object\n     */\n    _onFieldPointerOver : function(e) {\n      this.getChildControl(\"current-preview\").setBackgroundColor(e.getTarget().getBackgroundColor());\n    },\n\n    /**\n     * Listener of pointerout event on a color field. Reset the preview pane's\n     * background color to the old color value.\n     *\n     * @param e {qx.event.type.Pointer} Incoming event object\n     */\n    _onFieldPointerOut : function(e) {\n      var red = this.getRed();\n      var green = this.getGreen();\n      var blue = this.getBlue();\n      var color = null;\n\n      if (red !== null || green !== null || blue !== null) {\n        color = qx.util.ColorUtil.rgbToRgbString([red, green, blue]);\n      }\n\n      this.getChildControl(\"current-preview\").setBackgroundColor(color);\n    },\n\n    /**\n     * Listener of execute event on the \"cancel\" button.\n     * Hides the ColorPopup and resets it's color value.\n     */\n    _onAutomaticBtnExecute : function()\n    {\n      this.setValue(null);\n      this.hide();\n    },\n\n\n    /**\n     * Listener of execute event on the \"Open ColorSelector\" button.\n     * Opens a ColorSelector widget and hides the ColorPopup.\n     */\n    _onSelectorButtonExecute : function()\n    {\n      this._createColorSelector();\n\n      this.exclude();\n\n      var red = this.getRed();\n      var green = this.getGreen();\n      var blue = this.getBlue();\n\n      if (red === null || green === null || blue === null)\n      {\n        red = 255;\n        green = 255;\n        blue = 255;\n      }\n\n      this.__colorSelector.setRed(red);\n      this.__colorSelector.setGreen(green);\n      this.__colorSelector.setBlue(blue);\n\n      this.__colorSelectorWindow.open();\n    },\n\n\n    /**\n     * Listener of execute event on the \"OK\" button.\n     * Hides the ColorPopup and sets it's color value to the selected color.\n     */\n    _onColorSelectorOk : function()\n    {\n      var sel = this.__colorSelector;\n      this.setValue(qx.util.ColorUtil.rgbToRgbString([sel.getRed(), sel.getGreen(), sel.getBlue()]));\n      this.__colorSelectorWindow.close();\n    },\n\n\n    /**\n     * Listener of execute event on the \"Cancel\" button.\n     * Hides the ColorPopup.\n     */\n    _onColorSelectorCancel : function() {\n      this.__colorSelectorWindow.close();\n    },\n\n    /**\n     * Listener for visibility changes.\n     * Sets preview pane's background color to the current color,\n     * when the popup is visible.\n     *\n     * @param e {qx.event.type.Data} Incoming event object\n     */\n    _onChangeVisibility : function(e) {\n      if (this.getVisibility() == \"visible\")\n      {\n        var red = this.getRed();\n        var green = this.getGreen();\n        var blue = this.getBlue();\n        var color = null;\n\n        if (red !== null || green !== null || blue !== null) {\n          color = qx.util.ColorUtil.rgbToRgbString([red, green, blue]);\n        }\n\n        this.getChildControl(\"selected-preview\").setBackgroundColor(color);\n        this.getChildControl(\"current-preview\").setBackgroundColor(color);\n      }\n    },\n\n    /**\n     * @lint ignoreReferenceField(_tables)\n     */\n    _tables :\n    {\n      core :\n      {\n        label : qx.locale.Manager.tr(\"Basic Colors\"),\n        values : [ \"#000\", \"#333\", \"#666\", \"#999\", \"#CCC\", \"#FFF\", \"red\", \"green\", \"blue\", \"yellow\", \"teal\", \"maroon\" ]\n      },\n\n      recent :\n      {\n        label : qx.locale.Manager.tr(\"Recent Colors\"),\n        values : [ ]\n      }\n    }\n  },\n\n\n  /*\n  *****************************************************************************\n     DESTRUCTOR\n  *****************************************************************************\n  */\n\n  destruct : function()\n  {\n    if (this.__colorSelectorWindow) {\n      this.__colorSelectorWindow.destroy();\n      this.__colorSelector.destroy();\n      this.__buttonBar.destroy();\n    }\n    this._tables = this.__boxes = null;\n  }\n});\n"
  ]
}