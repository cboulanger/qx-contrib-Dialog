{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/qx-contrib-Dialog/node_modules/qxcompiler/node_modules/qooxdoo-sdk/framework/source/class/qx/ui/form/SelectBox.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "form",
    "AbstractSelectBox",
    "implement",
    "core",
    "ISingleSelection",
    "IModelSelection",
    "IField",
    "include",
    "MSingleSelectionHandling",
    "MModelSelection",
    "construct",
    "_createChildControl",
    "addListener",
    "_onPointerOver",
    "_onPointerOut",
    "_onTap",
    "_onKeyInput",
    "__onChangeSelection",
    "properties",
    "appearance",
    "refine",
    "init",
    "rich",
    "check",
    "apply",
    "members",
    "__preSelectedItem",
    "_applyRich",
    "value",
    "oldValue",
    "getChildControl",
    "setRich",
    "_defaultFormat",
    "item",
    "isRich",
    "getLabel",
    "_createChildControlImpl",
    "id",
    "hash",
    "control",
    "Spacer",
    "_add",
    "flex",
    "basic",
    "Atom",
    "setCenter",
    "setAnonymous",
    "Image",
    "_forwardStates",
    "focused",
    "_getItems",
    "getChildrenContainer",
    "getChildren",
    "_isAllowEmptySelection",
    "getSelectionMode",
    "e",
    "listItem",
    "getData",
    "list",
    "getSelection",
    "setSelection",
    "resetSelection",
    "__updateIcon",
    "__updateLabel",
    "atom",
    "icon",
    "getIcon",
    "resetIcon",
    "setIcon",
    "label",
    "format",
    "getFormat",
    "call",
    "translate",
    "resetLabel",
    "setLabel",
    "isEnabled",
    "getTarget",
    "hasState",
    "removeState",
    "addState",
    "toggle",
    "_onKeyPress",
    "iden",
    "getKeyIdentifier",
    "clone",
    "setTarget",
    "_list",
    "setBubbles",
    "dispatchEvent",
    "_onListPointerDown",
    "_onListChangeSelection",
    "current",
    "old",
    "getOldData",
    "length",
    "removeListener",
    "popup",
    "context",
    "getSelectionContext",
    "isVisible",
    "_onPopupChangeVisibility",
    "hasChildren",
    "distance",
    "getLayoutLocation",
    "viewPortHeight",
    "bom",
    "Viewport",
    "getHeight",
    "toTop",
    "top",
    "toBottom",
    "bottom",
    "availableHeigth",
    "maxListHeight",
    "getMaxListHeight",
    "setMaxHeight",
    "destruct",
    "SelectBox"
  ],
  "mappings": "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",
  "file": "SelectBox.js",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Martin Wittemann (martinwittemann)\n     * Sebastian Werner (wpbasti)\n     * Jonathan Wei√ü (jonathan_rass)\n     * Christian Hagendorn (chris_schmidt)\n\n************************************************************************ */\n\n/**\n * A form widget which allows a single selection. Looks somewhat like\n * a normal button, but opens a list of items to select when tapping on it.\n *\n * Keep in mind that the SelectBox widget has always a selected item (due to the\n * single selection mode). Right after adding the first item a <code>changeSelection</code>\n * event is fired.\n *\n * <pre class='javascript'>\n * var selectBox = new qx.ui.form.SelectBox();\n *\n * selectBox.addListener(\"changeSelection\", function(e) {\n *   // ...\n * });\n *\n * // now the 'changeSelection' event is fired\n * selectBox.add(new qx.ui.form.ListItem(\"Item 1\"));\n * </pre>\n *\n * @childControl spacer {qx.ui.core.Spacer} flexible spacer widget\n * @childControl atom {qx.ui.basic.Atom} shows the text and icon of the content\n * @childControl arrow {qx.ui.basic.Image} shows the arrow to open the popup\n */\nqx.Class.define(\"qx.ui.form.SelectBox\",\n{\n  extend : qx.ui.form.AbstractSelectBox,\n  implement : [\n    qx.ui.core.ISingleSelection,\n    qx.ui.form.IModelSelection,\n    qx.ui.form.IField\n  ],\n  include : [qx.ui.core.MSingleSelectionHandling, qx.ui.form.MModelSelection],\n\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n\n  construct : function()\n  {\n    this.base(arguments);\n\n    this._createChildControl(\"atom\");\n    this._createChildControl(\"spacer\");\n    this._createChildControl(\"arrow\");\n\n    // Register listener\n    this.addListener(\"pointerover\", this._onPointerOver, this);\n    this.addListener(\"pointerout\", this._onPointerOut, this);\n    this.addListener(\"tap\", this._onTap, this);\n\n    this.addListener(\"keyinput\", this._onKeyInput, this);\n    this.addListener(\"changeSelection\", this.__onChangeSelection, this);\n  },\n\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n\n  properties :\n  {\n    // overridden\n    appearance :\n    {\n      refine : true,\n      init : \"selectbox\"\n    },\n    \n    rich: {\n      init: false,\n      check: \"Boolean\",\n      apply: \"_applyRich\"\n    }\n  },\n\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n\n  members :\n  {\n    /** @type {qx.ui.form.ListItem} instance */\n    __preSelectedItem : null,\n\n\n    /*\n    ---------------------------------------------------------------------------\n      WIDGET API\n    ---------------------------------------------------------------------------\n    */\n\n    _applyRich: function(value, oldValue) {\n      this.getChildControl(\"atom\").setRich(value);\n    },\n    \n    // overridden\n    _defaultFormat: function(item) {\n      if (item) {\n        if (typeof item.isRich == \"function\" && item.isRich()) {\n          this.setRich(true);\n        }\n        return item.getLabel();\n      }\n      return null;\n    },\n\n    // overridden\n    _createChildControlImpl : function(id, hash)\n    {\n      var control;\n\n      switch(id)\n      {\n        case \"spacer\":\n          control = new qx.ui.core.Spacer();\n          this._add(control, {flex: 1});\n          break;\n\n        case \"atom\":\n          control = new qx.ui.basic.Atom(\" \");\n          control.setCenter(false);\n          control.setAnonymous(true);\n\n          this._add(control, {flex:1});\n          break;\n\n        case \"arrow\":\n          control = new qx.ui.basic.Image();\n          control.setAnonymous(true);\n\n          this._add(control);\n          break;\n      }\n\n      return control || this.base(arguments, id);\n    },\n\n    // overridden\n    /**\n     * @lint ignoreReferenceField(_forwardStates)\n     */\n    _forwardStates : {\n      focused : true\n    },\n\n\n    /*\n    ---------------------------------------------------------------------------\n      HELPER METHODS FOR SELECTION API\n    ---------------------------------------------------------------------------\n    */\n\n\n    /**\n     * Returns the list items for the selection.\n     *\n     * @return {qx.ui.form.ListItem[]} List items to select.\n     */\n    _getItems : function() {\n      return this.getChildrenContainer().getChildren();\n    },\n\n    /**\n     * Returns if the selection could be empty or not.\n     *\n     * @return {Boolean} <code>true</code> If selection could be empty,\n     *    <code>false</code> otherwise.\n     */\n    _isAllowEmptySelection: function() {\n      return this.getChildrenContainer().getSelectionMode() !== \"one\";\n    },\n\n    /**\n     * Event handler for <code>changeSelection</code>.\n     *\n     * @param e {qx.event.type.Data} Data event.\n     */\n    __onChangeSelection : function(e)\n    {\n      var listItem = e.getData()[0];\n\n      var list = this.getChildControl(\"list\");\n      if (list.getSelection()[0] != listItem) {\n        if(listItem) {\n          list.setSelection([listItem]);\n        } else {\n          list.resetSelection();\n        }\n      }\n\n      this.__updateIcon();\n      this.__updateLabel();\n    },\n\n\n    /**\n     * Sets the icon inside the list to match the selected ListItem.\n     */\n    __updateIcon : function()\n    {\n      var listItem = this.getChildControl(\"list\").getSelection()[0];\n      var atom = this.getChildControl(\"atom\");\n      var icon = listItem ? listItem.getIcon() : \"\";\n      icon == null ? atom.resetIcon() : atom.setIcon(icon);\n    },\n\n    /**\n     * Sets the label inside the list to match the selected ListItem.\n     */\n    __updateLabel : function()\n    {\n      var listItem = this.getChildControl(\"list\").getSelection()[0];\n      var atom = this.getChildControl(\"atom\");\n      var label = listItem ? listItem.getLabel() : \"\";\n      var format = this.getFormat();\n      if (format != null && listItem) {\n        label = format.call(this, listItem);\n      }\n\n      // check for translation\n      if (label && label.translate) {\n        label = label.translate();\n      }\n      label == null ? atom.resetLabel() : atom.setLabel(label);\n    },\n\n\n    /*\n    ---------------------------------------------------------------------------\n      EVENT LISTENERS\n    ---------------------------------------------------------------------------\n    */\n\n\n    /**\n     * Listener method for \"pointerover\" event\n     * <ul>\n     * <li>Adds state \"hovered\"</li>\n     * <li>Removes \"abandoned\" and adds \"pressed\" state (if \"abandoned\" state is set)</li>\n     * </ul>\n     *\n     * @param e {qx.event.type.Pointer} Pointer event\n     */\n    _onPointerOver : function(e)\n    {\n      if (!this.isEnabled() || e.getTarget() !== this) {\n        return;\n      }\n\n      if (this.hasState(\"abandoned\"))\n      {\n        this.removeState(\"abandoned\");\n        this.addState(\"pressed\");\n      }\n\n      this.addState(\"hovered\");\n    },\n\n\n    /**\n     * Listener method for \"pointerout\" event\n     * <ul>\n     * <li>Removes \"hovered\" state</li>\n     * <li>Adds \"abandoned\" and removes \"pressed\" state (if \"pressed\" state is set)</li>\n     * </ul>\n     *\n     * @param e {qx.event.type.Pointer} Pointer event\n     */\n    _onPointerOut : function(e)\n    {\n      if (!this.isEnabled() || e.getTarget() !== this) {\n        return;\n      }\n\n      this.removeState(\"hovered\");\n\n      if (this.hasState(\"pressed\"))\n      {\n        this.removeState(\"pressed\");\n        this.addState(\"abandoned\");\n      }\n    },\n\n\n    /**\n     * Toggles the popup's visibility.\n     *\n     * @param e {qx.event.type.Pointer} Pointer event\n     */\n    _onTap : function(e) {\n      this.toggle();\n    },\n\n\n    // overridden\n    _onKeyPress : function(e)\n    {\n      var iden = e.getKeyIdentifier();\n      if(iden == \"Enter\" || iden == \"Space\")\n      {\n        // Apply pre-selected item (translate quick selection to real selection)\n        if (this.__preSelectedItem)\n        {\n          this.setSelection([this.__preSelectedItem]);\n          this.__preSelectedItem = null;\n        }\n\n        this.toggle();\n      }\n      else\n      {\n        this.base(arguments, e);\n      }\n    },\n\n    /**\n     * Forwards key event to list widget.\n     *\n     * @param e {qx.event.type.KeyInput} Key event\n     */\n    _onKeyInput : function(e)\n    {\n      // clone the event and re-calibrate the event\n      var clone = e.clone();\n      clone.setTarget(this._list);\n      clone.setBubbles(false);\n\n      // forward it to the list\n      this.getChildControl(\"list\").dispatchEvent(clone);\n    },\n\n\n    // overridden\n    _onListPointerDown : function(e)\n    {\n      // Apply pre-selected item (translate quick selection to real selection)\n      if (this.__preSelectedItem)\n      {\n        this.setSelection([this.__preSelectedItem]);\n        this.__preSelectedItem = null;\n      }\n    },\n\n\n    // overridden\n    _onListChangeSelection : function(e)\n    {\n      var current = e.getData();\n      var old = e.getOldData();\n\n      // Remove old listeners for icon and label changes.\n      if (old && old.length > 0)\n      {\n        old[0].removeListener(\"changeIcon\", this.__updateIcon, this);\n        old[0].removeListener(\"changeLabel\", this.__updateLabel, this);\n      }\n\n\n      if (current.length > 0)\n      {\n        // Ignore quick context (e.g. pointerover)\n        // and configure the new value when closing the popup afterwards\n        var popup = this.getChildControl(\"popup\");\n        var list = this.getChildControl(\"list\");\n        var context = list.getSelectionContext();\n\n        if (popup.isVisible() && (context == \"quick\" || context == \"key\"))\n        {\n          this.__preSelectedItem = current[0];\n        }\n        else\n        {\n          this.setSelection([current[0]]);\n          this.__preSelectedItem = null;\n        }\n\n        // Add listeners for icon and label changes\n        current[0].addListener(\"changeIcon\", this.__updateIcon, this);\n        current[0].addListener(\"changeLabel\", this.__updateLabel, this);\n      }\n      else\n      {\n        this.resetSelection();\n      }\n    },\n\n    // overridden\n    _onPopupChangeVisibility : function(e)\n    {\n      this.base(arguments, e);\n\n      // Synchronize the current selection to the list selection\n      // when the popup is closed. The list selection may be invalid\n      // because of the quick selection handling which is not\n      // directly applied to the selectbox\n      var popup = this.getChildControl(\"popup\");\n      if (!popup.isVisible())\n      {\n        var list = this.getChildControl(\"list\");\n\n        // check if the list has any children before selecting\n        if (list.hasChildren()) {\n          list.setSelection(this.getSelection());\n        }\n      } else {\n        // ensure that the list is never bigger that the max list height and\n        // the available space in the viewport\n        var distance = popup.getLayoutLocation(this);\n        var viewPortHeight = qx.bom.Viewport.getHeight();\n        // distance to the bottom and top borders of the viewport\n        var toTop = distance.top;\n        var toBottom = viewPortHeight - distance.bottom;\n        var availableHeigth = toTop > toBottom ? toTop : toBottom;\n\n        var maxListHeight = this.getMaxListHeight();\n        var list = this.getChildControl(\"list\");\n        if (maxListHeight == null || maxListHeight > availableHeigth) {\n          list.setMaxHeight(availableHeigth);\n        } else if (maxListHeight < availableHeigth) {\n          list.setMaxHeight(maxListHeight);\n        }\n      }\n    }\n\n  },\n\n\n  /*\n  *****************************************************************************\n     DESTRUCT\n  *****************************************************************************\n  */\n\n\n  destruct : function() {\n    this.__preSelectedItem = null;\n  }\n});\n"
  ]
}